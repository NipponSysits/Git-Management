const config 		= require('$custom/config');
const mongoose 	= require('mongoose');
const name = (config.arg == 'default') ? 'logs' : 'test'
const cache = (config.arg == 'default') ? 'cache' : 'test';

mongoose.connect(config.mongoose);

const Schema = {
	Commits: mongoose.Schema({
	  commit_id: String,
	  repository_id: Number,
	  author: String,
	  email: String,
		subject: String,
		comment: String,
		logs: Boolean,
	  since: Date
	}),
	Repository: mongoose.Schema({
	  repository_id: Number,
	  name: String,
	  title: String,
	  description: String,
	  master: String,
	  branch: [String],
	  files: [{
	  	filename: String, 
	  	ext: String, 
	  	size: Number, 
	  	since: Date, 
	  	comment: String
	  }]
	}),
	Clients: mongoose.Schema({
	  user_id: Number,
	  fullname: String,
	}),
	Users: mongoose.Schema({
	 any: {} 
	})
}

module.exports = {
	Commit: mongoose.model(name+'_commits', Schema.Commits),
	Client: mongoose.model(cache+'.clients', Schema.Clients),
	Repository: mongoose.model(cache+'.repositories', Schema.Repository),
	User: mongoose.model('users', Schema.Users),
}